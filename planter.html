<!DOCTYPE html>
<html lang="da">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Dosis&family=Poppins:wght@300&family=Zen+Kaku+Gothic+Antique&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Rowdies:wght@300&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />
    <title>Planter</title>
  </head>
  <body>
    <header>
      <div class="linje">
        <button class="toggle-btn">☰</button>
        <h1 class="navn">POT-it</h1>
        <div class="hjem">
          <a href="index.html">
            <img
              src="billeder/plante_logo.svg"
              alt="logo med tre potteplanter"
              class="logo"
            />
          </a>
        </div>
      </div>

      <nav>
        <ul>
          <li>
            <a href="info.html">Info</a>
          </li>

          <li>
            <a href="planter.html">Planter</a>
          </li>

          <li>
            <a href="om.html">Om os</a>
          </li>
        </ul>
      </nav>
    </header>

    <main>
      <div>
        <img src="" alt="" />

        <h1>Find din plante her</h1>

        <h2 class="kategori">Alle</h2>
      </div>

      <nav class="kategorier">
        <button data-kategori="alle" class="valgt">Alle</button>
        <button data-kategori="kaktus">Kaktus</button>
        <button data-kategori="træ">Træer</button>
        <button data-kategori="hængeplante">Hængeplanter</button>
        <button data-kategori="succulent">Succulent</button>
        <button data-kategori="lille">Små</button>
        <button data-kategori="mellem">Mellem</button>
        <button data-kategori="stor">Store</button>
        <button data-kategori="svær">Svære</button>
        <button data-kategori="nem">Nemme</button>
      </nav>

      <section class="test"></section>

      <template>
        <article class="plante">
          <h2></h2>
          <img src="" alt="" />
        </article>
      </template>
    </main>

    <footer></footer>

    <script src="passion.js">
      const url = "https://tema7-64ef.restdb.io/rest/planter"
      const key = "61fcfa4d3f215f310a37be8a"
      let planter;
      const header = document.querySelector(".kategori")

      const options= {
          headers: {
            "x-apikey": key,
        },
      };    

      document.addEventListener("DOMContentLoaded", start);
      let filter = "alle";
      //første funktion der kaldes efter dom er loaded
      function start(){
        const filterKnapper = document.querySelectorAll("nav button");
        filterKnapper.forEach(knap => knap.addEventListener("click", filtrerPlanter));
        hentdata();
      }

      //eventlistener knyttet til knapperne der vælger hvad for et filter der er aktivt
      function filtrerPlanter(){
        filter = this.dataset.kategori; //Sæt variabel "filter" til værdien af data-kategori på den knap der er klikket på
        document.querySelector(".valgt").classList.remove("valgt") //fjern klassen valgt på den knap
        this.classList.add("valgt") //marker den knap der klikket på 
        vis(); // Kald funktionen vis() efter det nye filter er sat
        header.textContent = this.textContent;
      }

      async function hentdata() {
        const respons = await fetch(url, options);
        planter = await respons.json();
        vis();
      }


      function vis(){
        console.log("Planter", planter)
        const container = document.querySelector("section");
        const temp = document.querySelector("template");
        container.textContent = ""; // Ryd container inden ny loop


  
        planter.forEach((plante) => {
          console.log("kategori", plante.type)
          if (filter == plante.type || filter == "alle" || filter == plante.størrelse || filter == plante.sværhedsgrad){

            const klon = temp.cloneNode(true).content;
           klon.querySelector("h2").textContent = plante.navn;
      
      
      
            klon.querySelector("img").src = "billeder/" + plante.billede;
            klon.querySelector("img").addEventListener("click", () => visDetaljer(plante));

            container.appendChild(klon);

          }

        });
  
      }

      function visDetaljer (hvad) {
        location.href = `plante-detalje.html?id=${hvad._id}`;
      }

      hentdata();

      
    </script>
  </body>
</html>
